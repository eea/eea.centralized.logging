worker_processes  16;

events {
    worker_connections 2048;
}

stream {
    upstream graylogserversudp {
        least_conn;
        server graylogmaster:12201;
        server graylogclient:12201;
    }

    server {
        listen 12201 udp;
        proxy_pass graylogserversudp;
    }

    upstream graylogserverstcp {
        least_conn;
        server graylogmaster:1514;
        server graylogclient:1514;
    }

    server {
        listen 1514;
        proxy_pass graylogserverstcp;
    }

}
